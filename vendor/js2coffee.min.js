if(typeof module=="undefined"){this.Narcissus=new Object}(function(){var a={options:{version:185,},hostGlobal:this};Narcissus=a})();Narcissus.definitions=(function(){var m=["END","\n",";",",","=","?",":","CONDITIONAL","||","&&","|","^","&","==","!=","===","!==","<","<=",">=",">","<<",">>",">>>","+","-","*","/","%","!","~","UNARY_PLUS","UNARY_MINUS","++","--",".","[","]","{","}","(",")","SCRIPT","BLOCK","LABEL","FOR_IN","CALL","NEW_WITH_ARGS","INDEX","ARRAY_INIT","OBJECT_INIT","PROPERTY_INIT","GETTER","SETTER","GROUP","LIST","LET_BLOCK","ARRAY_COMP","GENERATOR","COMP_TAIL","IDENTIFIER","NUMBER","STRING","REGEXP","break","case","catch","const","continue","debugger","default","delete","do","else","false","finally","for","function","if","in","instanceof","let","new","null","return","switch","this","throw","true","try","typeof","var","void","yield","while","with",];var g=["break","const","continue","debugger","do","for","if","return","switch","throw","try","var","yield","while","with",];var d={"\n":"NEWLINE",";":"SEMICOLON",",":"COMMA","?":"HOOK",":":"COLON","||":"OR","&&":"AND","|":"BITWISE_OR","^":"BITWISE_XOR","&":"BITWISE_AND","===":"STRICT_EQ","==":"EQ","=":"ASSIGN","!==":"STRICT_NE","!=":"NE","<<":"LSH","<=":"LE","<":"LT",">>>":"URSH",">>":"RSH",">=":"GE",">":"GT","++":"INCREMENT","--":"DECREMENT","+":"PLUS","-":"MINUS","*":"MUL","/":"DIV","%":"MOD","!":"NOT","~":"BITWISE_NOT",".":"DOT","[":"LEFT_BRACKET","]":"RIGHT_BRACKET","{":"LEFT_CURLY","}":"RIGHT_CURLY","(":"LEFT_PAREN",")":"RIGHT_PAREN"};var f={__proto__:null};var l={};var p="const ";for(var u=0,r=m.length;u<r;u++){if(u>0){p+=", "}var k=m[u];var y;if(/^[a-z]/.test(k)){y=k.toUpperCase();f[k]=u}else{y=(/^\W/.test(k)?d[k]:k)}p+=y+" = "+u;l[y]=u;m[k]=u}p+=";";var b={__proto__:null};for(u=0,r=g.length;u<r;u++){b[f[g[u]]]=true}var e=["|","^","&","<<",">>",">>>","+","-","*","/","%"];for(u=0,r=e.length;u<r;u++){k=e[u];e[k]=m[k]}function a(z,A,t,j,i){Object.defineProperty(z,A,{get:t,configurable:!j,enumerable:!i})}function c(t,B,z,j,A,i){Object.defineProperty(t,B,{value:z,writable:!A,configurable:!j,enumerable:!i})}function w(i){return((typeof i)==="function")&&i.toString().match(/\[native code\]/)}function q(j,i){while(j){if(({}).hasOwnProperty.call(j,i)){return Object.getOwnPropertyDescriptor(j,i)}j=Object.getPrototypeOf(j)}}function x(t){var j={};for(var i in Object.getOwnPropertyNames(t)){j[i]=Object.getOwnPropertyDescriptor(t,i)}return j}function o(i){return{getOwnPropertyDescriptor:function(j){var t=Object.getOwnPropertyDescriptor(i,j);t.configurable=true;return t},getPropertyDescriptor:function(j){var t=q(i,j);t.configurable=true;return t},getOwnPropertyNames:function(){return Object.getOwnPropertyNames(i)},defineProperty:function(j,t){Object.defineProperty(i,j,t)},"delete":function(j){return delete i[j]},fix:function(){if(Object.isFrozen(i)){return x(i)}return undefined},has:function(j){return j in i},hasOwn:function(j){return({}).hasOwnProperty.call(i,j)},get:function(t,j){return i[j]},set:function(t,j,z){i[j]=z;return true},enumerate:function(){var j=[];for(y in i){j.push(y)}return j},keys:function(){return Object.keys(i)}}}function s(){return undefined}var h=({}).hasOwnProperty;function v(){this.table=Object.create(null,{});this.size=0}v.prototype={has:function(i){return h.call(this.table,i)},set:function(i,j){if(!h.call(this.table,i)){this.size++}this.table[i]=j},get:function(i){return this.table[i]},getDef:function(i,j){if(!h.call(this.table,i)){this.size++;this.table[i]=j()}return this.table[i]},forEach:function(t){var j=this.table;for(var i in j){t.call(this,i,j[i])}},toString:function(){return"[object StringMap]"}};function n(i){this.elts=i||null}n.prototype={push:function(i){return new n({top:i,rest:this.elts})},top:function(){if(!this.elts){throw new Error("empty stack")}return this.elts.top},isEmpty:function(){return this.top===null},find:function(j){for(var i=this.elts;i;i=i.rest){if(j(i.top)){return i.top}}return null},has:function(i){return Boolean(this.find(function(j){return j===i}))},forEach:function(i){for(var j=this.elts;j;j=j.rest){i(j.top)}}};return{tokens:m,opTypeNames:d,keywords:f,isStatementStartCode:b,tokenIds:l,consts:p,assignOps:e,defineGetter:a,defineProperty:c,isNativeCode:w,makePassthruHandler:o,noPropFound:s,StringMap:v,Stack:n}}());Narcissus.lexer=(function(){var definitions=Narcissus.definitions;eval(definitions.consts);var opTokens={};for(var op in definitions.opTypeNames){if(op==="\n"||op==="."){continue}var node=opTokens;for(var i=0;i<op.length;i++){var ch=op[i];if(!(ch in node)){node[ch]={}}node=node[ch];node.op=op}}function Tokenizer(s,f,l){this.cursor=0;this.source=String(s);this.tokens=[];this.tokenIndex=0;this.lookahead=0;this.scanNewlines=false;this.unexpectedEOF=false;this.filename=f||"";this.lineno=l||1;this.comments=[]}Tokenizer.prototype={get donefunction(){return this.peek(true)===END},get tokenfunction(){return this.tokens[this.tokenIndex]},match:function(tt,scanOperand){return this.get(scanOperand)===tt||this.unget()},mustMatch:function(tt){if(!this.match(tt)){throw this.newSyntaxError("Missing "+definitions.tokens[tt].toLowerCase())}return this.token},peek:function(scanOperand){var tt,next;if(this.lookahead){next=this.tokens[(this.tokenIndex+this.lookahead)&3];tt=(this.scanNewlines&&next.lineno!==this.lineno)?NEWLINE:next.type}else{tt=this.get(scanOperand);this.unget()}return tt},peekOnSameLine:function(scanOperand){this.scanNewlines=true;var tt=this.peek(scanOperand);this.scanNewlines=false;return tt},skip:function(){var input=this.source;var cstart;var clineno;var comments=[];var comment;var nlcount=0;for(;;){var ch=input[this.cursor++];var next=input[this.cursor];if(ch==="\n"&&!this.scanNewlines){this.lineno++;nlcount++}else{if(ch==="/"&&next==="*"){cstart=this.cursor;clineno=this.lineno;this.cursor++;for(;;){ch=input[this.cursor++];if(ch===undefined){throw this.newSyntaxError("Unterminated comment")}if(ch==="*"){next=input[this.cursor];if(next==="/"){this.cursor++;comment={type:"BLOCK_COMMENT",nlcount:nlcount,start:cstart-1,end:this.cursor,lineno:clineno,endlineno:this.lineno,value:input.substring(cstart+1,this.cursor-2)};this.comments.push(comment);nlcount=0;break}}else{if(ch==="\n"){this.lineno++}}}}else{if(ch==="/"&&next==="/"){cstart=this.cursor;this.cursor++;for(;;){ch=input[this.cursor++];if(ch===undefined){comment={type:"LINE_COMMENT",start:cstart,end:this.cursor,lineno:this.lineno,nlcount:nlcount,value:input.substring(cstart+1,this.cursor-1)};this.comments.push(comment);return}if(ch==="\n"){comment={type:"LINE_COMMENT",start:cstart,end:this.cursor,lineno:this.lineno,nlcount:nlcount,value:input.substring(cstart+1,this.cursor-1)};this.comments.push(comment);nlcount=0;this.lineno++;break}}}else{if(ch!==" "&&ch!=="\t"){this.cursor--;return}}}}}},lexExponent:function(){var input=this.source;var next=input[this.cursor];if(next==="e"||next==="E"){this.cursor++;ch=input[this.cursor++];if(ch==="+"||ch==="-"){ch=input[this.cursor++]}if(ch<"0"||ch>"9"){throw this.newSyntaxError("Missing exponent")}do{ch=input[this.cursor++]}while(ch>="0"&&ch<="9");this.cursor--;return true}return false},lexZeroNumber:function(ch){var token=this.token,input=this.source;token.type=NUMBER;ch=input[this.cursor++];if(ch==="."){do{ch=input[this.cursor++]}while(ch>="0"&&ch<="9");this.cursor--;this.lexExponent();token.value=parseFloat(token.start,this.cursor)}else{if(ch==="x"||ch==="X"){do{ch=input[this.cursor++]}while((ch>="0"&&ch<="9")||(ch>="a"&&ch<="f")||(ch>="A"&&ch<="F"));this.cursor--;token.value=parseInt(input.substring(token.start,this.cursor))}else{if(ch>="0"&&ch<="7"){do{ch=input[this.cursor++]}while(ch>="0"&&ch<="7");this.cursor--;token.value=parseInt(input.substring(token.start,this.cursor))}else{this.cursor--;this.lexExponent();token.value=0}}}},lexNumber:function(ch){var token=this.token,input=this.source;token.type=NUMBER;var floating=false;do{ch=input[this.cursor++];if(ch==="."&&!floating){floating=true;ch=input[this.cursor++]}}while(ch>="0"&&ch<="9");this.cursor--;var exponent=this.lexExponent();floating=floating||exponent;var str=input.substring(token.start,this.cursor);token.value=floating?parseFloat(str):parseInt(str)},lexDot:function(ch){var token=this.token,input=this.source;var next=input[this.cursor];if(next>="0"&&next<="9"){do{ch=input[this.cursor++]}while(ch>="0"&&ch<="9");this.cursor--;this.lexExponent();token.type=NUMBER;token.value=parseFloat(token.start,this.cursor)}else{token.type=DOT;token.assignOp=null;token.value="."}},lexString:function(ch){var token=this.token,input=this.source;token.type=STRING;var hasEscapes=false;var delim=ch;while((ch=input[this.cursor++])!==delim){if(this.cursor>=input.length){throw this.newSyntaxError("Unterminated string literal")}if(ch==="\\"){hasEscapes=true;if(++this.cursor==input.length){throw this.newSyntaxError("Unterminated string literal")}}}token.value=hasEscapes?eval(input.substring(token.start,this.cursor)):input.substring(token.start+1,this.cursor-1)},lexRegExp:function(ch){var token=this.token,input=this.source;token.type=REGEXP;do{ch=input[this.cursor++];if(ch==="\\"){this.cursor++}else{if(ch==="["){do{if(ch===undefined){throw this.newSyntaxError("Unterminated character class")}if(ch==="\\"){this.cursor++}ch=input[this.cursor++]}while(ch!=="]")}else{if(ch===undefined){throw this.newSyntaxError("Unterminated regex")}}}}while(ch!=="/");do{ch=input[this.cursor++]}while(ch>="a"&&ch<="z");this.cursor--;token.value=eval(input.substring(token.start,this.cursor))},lexOp:function(ch){var token=this.token,input=this.source;var node=opTokens[ch];var next=input[this.cursor];if(next in node){node=node[next];this.cursor++;next=input[this.cursor];if(next in node){node=node[next];this.cursor++;next=input[this.cursor]}}var op=node.op;if(definitions.assignOps[op]&&input[this.cursor]==="="){this.cursor++;token.type=ASSIGN;token.assignOp=definitions.tokenIds[definitions.opTypeNames[op]];op+="="}else{token.type=definitions.tokenIds[definitions.opTypeNames[op]];token.assignOp=null}token.value=op},lexIdent:function(ch){var token=this.token,input=this.source;do{ch=input[this.cursor++]}while((ch>="a"&&ch<="z")||(ch>="A"&&ch<="Z")||(ch>="0"&&ch<="9")||ch==="$"||ch==="_");this.cursor--;var id=input.substring(token.start,this.cursor);token.type=definitions.keywords[id]||IDENTIFIER;token.value=id},get:function(scanOperand){var token;while(this.lookahead){--this.lookahead;this.tokenIndex=(this.tokenIndex+1)&3;token=this.tokens[this.tokenIndex];if(token.type!==NEWLINE||this.scanNewlines){return token.type}}this.skip();this.tokenIndex=(this.tokenIndex+1)&3;token=this.tokens[this.tokenIndex];if(!token){this.tokens[this.tokenIndex]=token={}}var input=this.source;if(this.cursor===input.length){return token.type=END}token.start=this.cursor;token.lineno=this.lineno;var ch=input[this.cursor++];if((ch>="a"&&ch<="z")||(ch>="A"&&ch<="Z")||ch==="$"||ch==="_"){this.lexIdent(ch)}else{if(scanOperand&&ch==="/"){this.lexRegExp(ch)}else{if(ch in opTokens){this.lexOp(ch)}else{if(ch==="."){this.lexDot(ch)}else{if(ch>="1"&&ch<="9"){this.lexNumber(ch)}else{if(ch==="0"){this.lexZeroNumber(ch)}else{if(ch==='"'||ch==="'"){this.lexString(ch)}else{if(this.scanNewlines&&ch==="\n"){token.type=NEWLINE;token.value="\n";this.lineno++}else{throw this.newSyntaxError("Illegal token")}}}}}}}}token.end=this.cursor;return token.type},unget:function(){if(++this.lookahead===4){throw"PANIC: too much lookahead!"}this.tokenIndex=(this.tokenIndex-1)&3},newSyntaxError:function(m){var e=new SyntaxError(m,this.filename,this.lineno);e.source=this.source;e.cursor=this.lookahead?this.tokens[(this.tokenIndex+this.lookahead)&3].start:this.cursor;return e},};return{Tokenizer:Tokenizer}}());Narcissus.parser=(function(){var lexer=Narcissus.lexer;var definitions=Narcissus.definitions;const StringMap=definitions.StringMap;const Stack=definitions.Stack;eval(definitions.consts);function pushDestructuringVarDecls(n,s){for(var i in n){var sub=n[i];if(sub.type===IDENTIFIER){s.varDecls.push(sub)}else{pushDestructuringVarDecls(sub,s)}}}const NESTING_TOP=0,NESTING_SHALLOW=1,NESTING_DEEP=2;function StaticContext(parentScript,parentBlock,inFunction,inForLoopInit,nesting){this.parentScript=parentScript;this.parentBlock=parentBlock;this.inFunction=inFunction;this.inForLoopInit=inForLoopInit;this.nesting=nesting;this.allLabels=new Stack();this.currentLabels=new Stack();this.labeledTargets=new Stack();this.defaultTarget=null;Narcissus.options.ecma3OnlyMode&&(this.ecma3OnlyMode=true);Narcissus.options.parenFreeMode&&(this.parenFreeMode=true)}StaticContext.prototype={ecma3OnlyMode:false,parenFreeMode:false,update:function(ext){var desc={};for(var key in ext){desc[key]={value:ext[key],writable:true,enumerable:true,configurable:true}}return Object.create(this,desc)},pushLabel:function(label){return this.update({currentLabels:this.currentLabels.push(label),allLabels:this.allLabels.push(label)})},pushTarget:function(target){var isDefaultTarget=target.isLoop||target.type===SWITCH;if(this.currentLabels.isEmpty()){return isDefaultTarget?this.update({defaultTarget:target}):this}target.labels=new StringMap();this.currentLabels.forEach(function(label){target.labels.set(label,true)});return this.update({currentLabels:new Stack(),labeledTargets:this.labeledTargets.push(target),defaultTarget:isDefaultTarget?target:this.defaultTarget})},nest:function(atLeast){var nesting=Math.max(this.nesting,atLeast);return(nesting!==this.nesting)?this.update({nesting:nesting}):this}};function Script(t,inFunction){var n=new Node(t,scriptInit());var x=new StaticContext(n,n,inFunction,false,NESTING_TOP);Statements(t,x,n);return n}definitions.defineProperty(Array.prototype,"top",function(){return this.length&&this[this.length-1]},false,false,true);function Node(t,init){var token=t.token;if(token){this.type=token.type;this.value=token.value;this.lineno=token.lineno;this.start=token.start;this.end=token.end}else{this.lineno=t.lineno}this.tokenizer=t;this.children=[];for(var prop in init){this[prop]=init[prop]}}var Np=Node.prototype={};Np.constructor=Node;Np.toSource=Object.prototype.toSource;Np.push=function(kid){if(kid!==null){if(kid.start<this.start){this.start=kid.start}if(this.end<kid.end){this.end=kid.end}}return this.children.push(kid)};Node.indentLevel=0;function tokenString(tt){var t=definitions.tokens[tt];return/^\W/.test(t)?definitions.opTypeNames[t]:t.toUpperCase()}Np.toString=function(){var a=[];for(var i in this){if(this.hasOwnProperty(i)&&i!=="type"&&i!=="target"){a.push({id:i,value:this[i]})}}a.sort(function(a,b){return(a.id<b.id)?-1:1});const INDENTATION="    ";var n=++Node.indentLevel;var s="{\n"+INDENTATION.repeat(n)+"type: "+tokenString(this.type);for(i=0;i<a.length;i++){s+=",\n"+INDENTATION.repeat(n)+a[i].id+": "+a[i].value}n=--Node.indentLevel;s+="\n"+INDENTATION.repeat(n)+"}";return s};Np.getSource=function(){return this.tokenizer.source.slice(this.start,this.end)};const LOOP_INIT={isLoop:true};function blockInit(){return{type:BLOCK,varDecls:[]}}function scriptInit(){return{type:SCRIPT,funDecls:[],varDecls:[],modDecls:[],impDecls:[],expDecls:[],loadDeps:[],hasEmptyReturn:false,hasReturnWithValue:false,isGenerator:false}}definitions.defineGetter(Np,"filename",function(){return this.tokenizer.filename});definitions.defineGetter(Np,"length",function(){throw new Error("Node.prototype.length is gone; use n.children.length instead")});definitions.defineProperty(String.prototype,"repeat",function(n){var s="",t=this+s;while(--n>=0){s+=t}return s},false,false,true);function MaybeLeftParen(t,x){if(x.parenFreeMode){return t.match(LEFT_PAREN)?LEFT_PAREN:END}return t.mustMatch(LEFT_PAREN).type}function MaybeRightParen(t,p){if(p===LEFT_PAREN){t.mustMatch(RIGHT_PAREN)}}function Statements(t,x,n){try{while(!t.done&&t.peek(true)!==RIGHT_CURLY){n.push(Statement(t,x))}}catch(e){if(t.done){t.unexpectedEOF=true}throw (e)}}function Block(t,x){t.mustMatch(LEFT_CURLY);var n=new Node(t,blockInit());Statements(t,x.update({parentBlock:n}).pushTarget(n),n);t.mustMatch(RIGHT_CURLY);return n}const DECLARED_FORM=0,EXPRESSED_FORM=1,STATEMENT_FORM=2;function Statement(t,x){var i,label,n,n2,p,c,ss,tt=t.get(true),tt2,x2,x3;switch(tt){case FUNCTION:return FunctionDefinition(t,x,true,(x.nesting!==NESTING_TOP)?STATEMENT_FORM:DECLARED_FORM);case LEFT_CURLY:n=new Node(t,blockInit());Statements(t,x.update({parentBlock:n}).pushTarget(n).nest(NESTING_SHALLOW),n);t.mustMatch(RIGHT_CURLY);return n;case IF:n=new Node(t);n.condition=HeadExpression(t,x);x2=x.pushTarget(n).nest(NESTING_DEEP);n.thenPart=Statement(t,x2);n.elsePart=t.match(ELSE)?Statement(t,x2):null;return n;case SWITCH:n=new Node(t,{cases:[],defaultIndex:-1});n.discriminant=HeadExpression(t,x);x2=x.pushTarget(n).nest(NESTING_DEEP);t.mustMatch(LEFT_CURLY);while((tt=t.get())!==RIGHT_CURLY){switch(tt){case DEFAULT:if(n.defaultIndex>=0){throw t.newSyntaxError("More than one switch default")}case CASE:n2=new Node(t);if(tt===DEFAULT){n.defaultIndex=n.cases.length}else{n2.caseLabel=Expression(t,x2,COLON)}break;default:throw t.newSyntaxError("Invalid switch case")}t.mustMatch(COLON);n2.statements=new Node(t,blockInit());while((tt=t.peek(true))!==CASE&&tt!==DEFAULT&&tt!==RIGHT_CURLY){n2.statements.push(Statement(t,x2))}n.cases.push(n2)}return n;case FOR:n=new Node(t,LOOP_INIT);if(t.match(IDENTIFIER)){if(t.token.value==="each"){n.isEach=true}else{t.unget()}}if(!x.parenFreeMode){t.mustMatch(LEFT_PAREN)}x2=x.pushTarget(n).nest(NESTING_DEEP);x3=x.update({inForLoopInit:true});if((tt=t.peek())!==SEMICOLON){if(tt===VAR||tt===CONST){t.get();n2=Variables(t,x3)}else{if(tt===LET){t.get();if(t.peek()===LEFT_PAREN){n2=LetBlock(t,x3,false)}else{x3.parentBlock=n;n.varDecls=[];n2=Variables(t,x3)}}else{n2=Expression(t,x3)}}}if(n2&&t.match(IN)){n.type=FOR_IN;n.object=Expression(t,x3);if(n2.type===VAR||n2.type===LET){c=n2.children;if(c.length!==1&&n2.destructurings.length!==1){throw new SyntaxError("Invalid for..in left-hand side",t.filename,n2.lineno)}if(n2.destructurings.length>0){n.iterator=n2.destructurings[0]}else{n.iterator=c[0]}n.varDecl=n2}else{if(n2.type===ARRAY_INIT||n2.type===OBJECT_INIT){n2.destructuredNames=checkDestructuring(t,x3,n2)}n.iterator=n2}}else{n.setup=n2;t.mustMatch(SEMICOLON);if(n.isEach){throw t.newSyntaxError("Invalid for each..in loop")}n.condition=(t.peek()===SEMICOLON)?null:Expression(t,x3);t.mustMatch(SEMICOLON);tt2=t.peek();n.update=(x.parenFreeMode?tt2===LEFT_CURLY||definitions.isStatementStartCode[tt2]:tt2===RIGHT_PAREN)?null:Expression(t,x3)}if(!x.parenFreeMode){t.mustMatch(RIGHT_PAREN)}n.body=Statement(t,x2);return n;case WHILE:n=new Node(t,{isLoop:true});n.condition=HeadExpression(t,x);n.body=Statement(t,x.pushTarget(n).nest(NESTING_DEEP));return n;case DO:n=new Node(t,{isLoop:true});n.body=Statement(t,x.pushTarget(n).nest(NESTING_DEEP));t.mustMatch(WHILE);n.condition=HeadExpression(t,x);if(!x.ecmaStrictMode){t.match(SEMICOLON);return n}break;case BREAK:case CONTINUE:n=new Node(t);x2=x.pushTarget(n);if(t.peekOnSameLine()===IDENTIFIER){t.get();n.label=t.token.value}n.target=n.label?x2.labeledTargets.find(function(target){return target.labels.has(n.label)}):x2.defaultTarget;if(!n.target){throw t.newSyntaxError("Invalid "+((tt===BREAK)?"break":"continue"))}if(!n.target.isLoop&&tt===CONTINUE){throw t.newSyntaxError("Invalid continue")}break;case TRY:n=new Node(t,{catchClauses:[]});n.tryBlock=Block(t,x);while(t.match(CATCH)){n2=new Node(t);p=MaybeLeftParen(t,x);switch(t.get()){case LEFT_BRACKET:case LEFT_CURLY:t.unget();n2.varName=DestructuringExpression(t,x,true);break;case IDENTIFIER:n2.varName=t.token.value;break;default:throw t.newSyntaxError("missing identifier in catch");break}if(t.match(IF)){if(x.ecma3OnlyMode){throw t.newSyntaxError("Illegal catch guard")}if(n.catchClauses.length&&!n.catchClauses.top().guard){throw t.newSyntaxError("Guarded catch after unguarded")}n2.guard=Expression(t,x)}MaybeRightParen(t,p);n2.block=Block(t,x);n.catchClauses.push(n2)}if(t.match(FINALLY)){n.finallyBlock=Block(t,x)}if(!n.catchClauses.length&&!n.finallyBlock){throw t.newSyntaxError("Invalid try statement")}return n;case CATCH:case FINALLY:throw t.newSyntaxError(definitions.tokens[tt]+" without preceding try");case THROW:n=new Node(t);n.exception=Expression(t,x);break;case RETURN:n=ReturnOrYield(t,x);break;case WITH:n=new Node(t);n.object=HeadExpression(t,x);n.body=Statement(t,x.pushTarget(n).nest(NESTING_DEEP));return n;case VAR:case CONST:n=Variables(t,x);break;case LET:if(t.peek()===LEFT_PAREN){n=LetBlock(t,x,true)}else{n=Variables(t,x)}break;case DEBUGGER:n=new Node(t);break;case NEWLINE:case SEMICOLON:n=new Node(t,{type:SEMICOLON});n.expression=null;return n;default:if(tt===IDENTIFIER){tt=t.peek();if(tt===COLON){label=t.token.value;if(x.allLabels.has(label)){throw t.newSyntaxError("Duplicate label")}t.get();n=new Node(t,{type:LABEL,label:label});n.statement=Statement(t,x.pushLabel(label).nest(NESTING_SHALLOW));n.target=(n.statement.type===LABEL)?n.statement.target:n.statement;return n}}n=new Node(t,{type:SEMICOLON});t.unget();n.expression=Expression(t,x);n.end=n.expression.end;break}MagicalSemicolon(t);return n}function MagicalSemicolon(t){var tt;if(t.lineno===t.token.lineno){tt=t.peekOnSameLine();if(tt!==END&&tt!==NEWLINE&&tt!==SEMICOLON&&tt!==RIGHT_CURLY){throw t.newSyntaxError("missing ; before statement")}}t.match(SEMICOLON)}function ReturnOrYield(t,x){var n,b,tt=t.token.type,tt2;var parentScript=x.parentScript;if(tt===RETURN){if(!x.inFunction){throw t.newSyntaxError("Return not in function")}}else{if(!x.inFunction){throw t.newSyntaxError("Yield not in function")}parentScript.isGenerator=true}n=new Node(t,{value:undefined});tt2=t.peek(true);if(tt2!==END&&tt2!==NEWLINE&&tt2!==SEMICOLON&&tt2!==RIGHT_CURLY&&(tt!==YIELD||(tt2!==tt&&tt2!==RIGHT_BRACKET&&tt2!==RIGHT_PAREN&&tt2!==COLON&&tt2!==COMMA))){if(tt===RETURN){n.value=Expression(t,x);parentScript.hasReturnWithValue=true}else{n.value=AssignExpression(t,x)}}else{if(tt===RETURN){parentScript.hasEmptyReturn=true}}if(parentScript.hasReturnWithValue&&parentScript.isGenerator){throw t.newSyntaxError("Generator returns a value")}return n}function FunctionDefinition(t,x,requireName,functionForm){var tt;var f=new Node(t,{params:[]});if(f.type!==FUNCTION){f.type=(f.value==="get")?GETTER:SETTER}if(t.match(IDENTIFIER)){f.name=t.token.value}else{if(requireName){throw t.newSyntaxError("missing function identifier")}}var x2=new StaticContext(null,null,true,false,NESTING_TOP);t.mustMatch(LEFT_PAREN);if(!t.match(RIGHT_PAREN)){do{switch(t.get()){case LEFT_BRACKET:case LEFT_CURLY:t.unget();f.params.push(DestructuringExpression(t,x2));break;case IDENTIFIER:f.params.push(t.token.value);break;default:throw t.newSyntaxError("missing formal parameter");break}}while(t.match(COMMA));t.mustMatch(RIGHT_PAREN)}tt=t.get();if(tt!==LEFT_CURLY){t.unget()}if(tt!==LEFT_CURLY){f.body=AssignExpression(t,x2);if(f.body.isGenerator){throw t.newSyntaxError("Generator returns a value")}}else{f.body=Script(t,true)}if(tt===LEFT_CURLY){t.mustMatch(RIGHT_CURLY)}f.end=t.token.end;f.functionForm=functionForm;if(functionForm===DECLARED_FORM){x.parentScript.funDecls.push(f)}return f}function Variables(t,x,letBlock){var n,n2,ss,i,s,tt;tt=t.token.type;switch(tt){case VAR:case CONST:s=x.parentScript;break;case LET:s=x.parentBlock;break;case LEFT_PAREN:tt=LET;s=letBlock;break}n=new Node(t,{type:tt,destructurings:[]});do{tt=t.get();if(tt===LEFT_BRACKET||tt===LEFT_CURLY){t.unget();var dexp=DestructuringExpression(t,x,true);n2=new Node(t,{type:IDENTIFIER,name:dexp,readOnly:n.type===CONST});n.push(n2);pushDestructuringVarDecls(n2.name.destructuredNames,s);n.destructurings.push({exp:dexp,decl:n2});if(x.inForLoopInit&&t.peek()===IN){continue}t.mustMatch(ASSIGN);if(t.token.assignOp){throw t.newSyntaxError("Invalid variable initialization")}n2.initializer=AssignExpression(t,x);continue}if(tt!==IDENTIFIER){throw t.newSyntaxError("missing variable name")}n2=new Node(t,{type:IDENTIFIER,name:t.token.value,readOnly:n.type===CONST});n.push(n2);s.varDecls.push(n2);if(t.match(ASSIGN)){if(t.token.assignOp){throw t.newSyntaxError("Invalid variable initialization")}n2.initializer=AssignExpression(t,x)}}while(t.match(COMMA));return n}function LetBlock(t,x,isStatement){var n,n2;n=new Node(t,{type:LET_BLOCK,varDecls:[]});t.mustMatch(LEFT_PAREN);n.variables=Variables(t,x,n);t.mustMatch(RIGHT_PAREN);if(isStatement&&t.peek()!==LEFT_CURLY){n2=new Node(t,{type:SEMICOLON,expression:n});isStatement=false}if(isStatement){n.block=Block(t,x)}else{n.expression=AssignExpression(t,x)}return n}function checkDestructuring(t,x,n,simpleNamesOnly){if(n.type===ARRAY_COMP){throw t.newSyntaxError("Invalid array comprehension left-hand side")}if(n.type!==ARRAY_INIT&&n.type!==OBJECT_INIT){return}var lhss={};var nn,n2,idx,sub,cc,c=n.children;for(var i=0,j=c.length;i<j;i++){if(!(nn=c[i])){continue}if(nn.type===PROPERTY_INIT){cc=nn.children;sub=cc[1];idx=cc[0].value}else{if(n.type===OBJECT_INIT){sub=nn;idx=nn.value}else{sub=nn;idx=i}}if(sub.type===ARRAY_INIT||sub.type===OBJECT_INIT){lhss[idx]=checkDestructuring(t,x,sub,simpleNamesOnly)}else{if(simpleNamesOnly&&sub.type!==IDENTIFIER){throw t.newSyntaxError("missing name in pattern")}lhss[idx]=sub}}return lhss}function DestructuringExpression(t,x,simpleNamesOnly){var n=PrimaryExpression(t,x);n.destructuredNames=checkDestructuring(t,x,n,simpleNamesOnly);return n}function GeneratorExpression(t,x,e){return new Node(t,{type:GENERATOR,expression:e,tail:ComprehensionTail(t,x)})}function ComprehensionTail(t,x){var body,n,n2,n3,p;body=new Node(t,{type:COMP_TAIL});do{n=new Node(t,{type:FOR_IN,isLoop:true});if(t.match(IDENTIFIER)){if(t.token.value==="each"){n.isEach=true}else{t.unget()}}p=MaybeLeftParen(t,x);switch(t.get()){case LEFT_BRACKET:case LEFT_CURLY:t.unget();n.iterator=DestructuringExpression(t,x);break;case IDENTIFIER:n.iterator=n3=new Node(t,{type:IDENTIFIER});n3.name=n3.value;n.varDecl=n2=new Node(t,{type:VAR});n2.push(n3);x.parentScript.varDecls.push(n3);break;default:throw t.newSyntaxError("missing identifier")}t.mustMatch(IN);n.object=Expression(t,x);MaybeRightParen(t,p);body.push(n)}while(t.match(FOR));if(t.match(IF)){body.guard=HeadExpression(t,x)}return body}function HeadExpression(t,x){var p=MaybeLeftParen(t,x);var n=ParenExpression(t,x);MaybeRightParen(t,p);if(p===END&&!n.parenthesized){var tt=t.peek();if(tt!==LEFT_CURLY&&!definitions.isStatementStartCode[tt]){throw t.newSyntaxError("Unparenthesized head followed by unbraced body")}}return n}function ParenExpression(t,x){var n=Expression(t,x.update({inForLoopInit:x.inForLoopInit&&(t.token.type===LEFT_PAREN)}));if(t.match(FOR)){if(n.type===YIELD&&!n.parenthesized){throw t.newSyntaxError("Yield expression must be parenthesized")}if(n.type===COMMA&&!n.parenthesized){throw t.newSyntaxError("Generator expression must be parenthesized")}n=GeneratorExpression(t,x,n)}return n}function Expression(t,x){var n,n2;n=AssignExpression(t,x);if(t.match(COMMA)){n2=new Node(t,{type:COMMA});n2.push(n);n=n2;do{n2=n.children[n.children.length-1];if(n2.type===YIELD&&!n2.parenthesized){throw t.newSyntaxError("Yield expression must be parenthesized")}n.push(AssignExpression(t,x))}while(t.match(COMMA))}return n}function AssignExpression(t,x){var n,lhs;if(t.match(YIELD,true)){return ReturnOrYield(t,x)}n=new Node(t,{type:ASSIGN});lhs=ConditionalExpression(t,x);if(!t.match(ASSIGN)){return lhs}switch(lhs.type){case OBJECT_INIT:case ARRAY_INIT:lhs.destructuredNames=checkDestructuring(t,x,lhs);case IDENTIFIER:case DOT:case INDEX:case CALL:break;default:throw t.newSyntaxError("Bad left-hand side of assignment");break}n.assignOp=t.token.assignOp;n.push(lhs);n.push(AssignExpression(t,x));return n}function ConditionalExpression(t,x){var n,n2;n=OrExpression(t,x);if(t.match(HOOK)){n2=n;n=new Node(t,{type:HOOK});n.push(n2);n.push(AssignExpression(t,x.update({inForLoopInit:false})));if(!t.match(COLON)){throw t.newSyntaxError("missing : after ?")}n.push(AssignExpression(t,x))}return n}function OrExpression(t,x){var n,n2;n=AndExpression(t,x);while(t.match(OR)){n2=new Node(t);n2.push(n);n2.push(AndExpression(t,x));n=n2}return n}function AndExpression(t,x){var n,n2;n=BitwiseOrExpression(t,x);while(t.match(AND)){n2=new Node(t);n2.push(n);n2.push(BitwiseOrExpression(t,x));n=n2}return n}function BitwiseOrExpression(t,x){var n,n2;n=BitwiseXorExpression(t,x);while(t.match(BITWISE_OR)){n2=new Node(t);n2.push(n);n2.push(BitwiseXorExpression(t,x));n=n2}return n}function BitwiseXorExpression(t,x){var n,n2;n=BitwiseAndExpression(t,x);while(t.match(BITWISE_XOR)){n2=new Node(t);n2.push(n);n2.push(BitwiseAndExpression(t,x));n=n2}return n}function BitwiseAndExpression(t,x){var n,n2;n=EqualityExpression(t,x);while(t.match(BITWISE_AND)){n2=new Node(t);n2.push(n);n2.push(EqualityExpression(t,x));n=n2}return n}function EqualityExpression(t,x){var n,n2;n=RelationalExpression(t,x);while(t.match(EQ)||t.match(NE)||t.match(STRICT_EQ)||t.match(STRICT_NE)){n2=new Node(t);n2.push(n);n2.push(RelationalExpression(t,x));n=n2}return n}function RelationalExpression(t,x){var n,n2;var x2=x.update({inForLoopInit:false});n=ShiftExpression(t,x2);while((t.match(LT)||t.match(LE)||t.match(GE)||t.match(GT)||(!x.inForLoopInit&&t.match(IN))||t.match(INSTANCEOF))){n2=new Node(t);n2.push(n);n2.push(ShiftExpression(t,x2));n=n2}return n}function ShiftExpression(t,x){var n,n2;n=AddExpression(t,x);while(t.match(LSH)||t.match(RSH)||t.match(URSH)){n2=new Node(t);n2.push(n);n2.push(AddExpression(t,x));n=n2}return n}function AddExpression(t,x){var n,n2;n=MultiplyExpression(t,x);while(t.match(PLUS)||t.match(MINUS)){n2=new Node(t);n2.push(n);n2.push(MultiplyExpression(t,x));n=n2}return n}function MultiplyExpression(t,x){var n,n2;n=UnaryExpression(t,x);while(t.match(MUL)||t.match(DIV)||t.match(MOD)){n2=new Node(t);n2.push(n);n2.push(UnaryExpression(t,x));n=n2}return n}function UnaryExpression(t,x){var n,n2,tt;switch(tt=t.get(true)){case DELETE:case VOID:case TYPEOF:case NOT:case BITWISE_NOT:case PLUS:case MINUS:if(tt===PLUS){n=new Node(t,{type:UNARY_PLUS})}else{if(tt===MINUS){n=new Node(t,{type:UNARY_MINUS})}else{n=new Node(t)}}n.push(UnaryExpression(t,x));break;case INCREMENT:case DECREMENT:n=new Node(t);n.push(MemberExpression(t,x,true));break;default:t.unget();n=MemberExpression(t,x,true);if(t.tokens[(t.tokenIndex+t.lookahead-1)&3].lineno===t.lineno){if(t.match(INCREMENT)||t.match(DECREMENT)){n2=new Node(t,{postfix:true});n2.push(n);n=n2}}break}return n}function MemberExpression(t,x,allowCallSyntax){var n,n2,name,tt;if(t.match(NEW)){n=new Node(t);n.push(MemberExpression(t,x,false));if(t.match(LEFT_PAREN)){n.type=NEW_WITH_ARGS;n.push(ArgumentList(t,x))}}else{n=PrimaryExpression(t,x)}while((tt=t.get())!==END){switch(tt){case DOT:n2=new Node(t);n2.push(n);t.mustMatch(IDENTIFIER);n2.push(new Node(t));break;case LEFT_BRACKET:n2=new Node(t,{type:INDEX});n2.push(n);n2.push(Expression(t,x));t.mustMatch(RIGHT_BRACKET);break;case LEFT_PAREN:if(allowCallSyntax){n2=new Node(t,{type:CALL});n2.push(n);n2.push(ArgumentList(t,x));break}default:t.unget();return n}n=n2}return n}function ArgumentList(t,x){var n,n2;n=new Node(t,{type:LIST});if(t.match(RIGHT_PAREN,true)){return n}do{n2=AssignExpression(t,x);if(n2.type===YIELD&&!n2.parenthesized&&t.peek()===COMMA){throw t.newSyntaxError("Yield expression must be parenthesized")}if(t.match(FOR)){n2=GeneratorExpression(t,x,n2);if(n.children.length>1||t.peek(true)===COMMA){throw t.newSyntaxError("Generator expression must be parenthesized")}}n.push(n2)}while(t.match(COMMA));t.mustMatch(RIGHT_PAREN);return n}function PrimaryExpression(t,x){var n,n2,tt=t.get(true);switch(tt){case FUNCTION:n=FunctionDefinition(t,x,false,EXPRESSED_FORM);break;case LEFT_BRACKET:n=new Node(t,{type:ARRAY_INIT});while((tt=t.peek(true))!==RIGHT_BRACKET){if(tt===COMMA){t.get();n.push(null);continue}n.push(AssignExpression(t,x));if(tt!==COMMA&&!t.match(COMMA)){break}}if(n.children.length===1&&t.match(FOR)){n2=new Node(t,{type:ARRAY_COMP,expression:n.children[0],tail:ComprehensionTail(t,x)});n=n2}t.mustMatch(RIGHT_BRACKET);break;case LEFT_CURLY:var id,fd;n=new Node(t,{type:OBJECT_INIT});object_init:if(!t.match(RIGHT_CURLY)){do{tt=t.get();if((t.token.value==="get"||t.token.value==="set")&&t.peek()===IDENTIFIER){if(x.ecma3OnlyMode){throw t.newSyntaxError("Illegal property accessor")}n.push(FunctionDefinition(t,x,true,EXPRESSED_FORM))}else{switch(tt){case IDENTIFIER:case NUMBER:case STRING:id=new Node(t,{type:IDENTIFIER});break;case RIGHT_CURLY:if(x.ecma3OnlyMode){throw t.newSyntaxError("Illegal trailing ,")}break object_init;default:if(t.token.value in definitions.keywords){id=new Node(t,{type:IDENTIFIER});break}throw t.newSyntaxError("Invalid property name")}if(t.match(COLON)){n2=new Node(t,{type:PROPERTY_INIT});n2.push(id);n2.push(AssignExpression(t,x));n.push(n2)}else{if(t.peek()!==COMMA&&t.peek()!==RIGHT_CURLY){throw t.newSyntaxError("missing : after property")}n.push(id)}}}while(t.match(COMMA));t.mustMatch(RIGHT_CURLY)}break;case LEFT_PAREN:n=ParenExpression(t,x);t.mustMatch(RIGHT_PAREN);n.parenthesized=true;break;case LET:n=LetBlock(t,x,false);break;case NULL:case THIS:case TRUE:case FALSE:case IDENTIFIER:case NUMBER:case STRING:case REGEXP:n=new Node(t);break;default:throw t.newSyntaxError("missing operand");break}return n}function parse(s,f,l){var t=new lexer.Tokenizer(s,f,l);var n=Script(t,false);if(!t.done){throw t.newSyntaxError("Syntax error")}return n}function parseStdin(s,ln){for(;;){try{var t=new lexer.Tokenizer(s,"stdin",ln.value);var n=Script(t,false);ln.value=t.lineno;return n}catch(e){if(!t.unexpectedEOF){throw e}var more=readline();if(!more){throw e}s+="\n"+more}}}return{parse:parse,parseStdin:parseStdin,Node:Node,DECLARED_FORM:DECLARED_FORM,EXPRESSED_FORM:EXPRESSED_FORM,STATEMENT_FORM:STATEMENT_FORM,Tokenizer:lexer.Tokenizer,FunctionDefinition:FunctionDefinition}}());var exports={definitions:Narcissus.definitions,lexer:Narcissus.lexer,parser:Narcissus.parser};if(typeof module!="undefined"){module.exports=exports}(function(){var g,b,c,d,f,a,h,i,j=Array.prototype.indexOf||function(n){for(var m=0,k=this.length;m<k;m++){if(m in this&&this[m]===n){return m}}return -1},e=Array.prototype.slice;f=this.Narcissus||require("./narcissus_packed");i=this._||require("underscore");h=f.definitions.tokens;a=f.parser;g=a.Node;g.prototype.left=function(){return this.children[0]};g.prototype.right=function(){return this.children[1]};g.prototype.last=function(){return this.children[this.children.length-1]};g.prototype.walk=function(k,m,l,n){if(l==null){l=null}if(n==null){n=null}if(l){m(l,this,n)}if(k.last){if(this.last()!=null){this.last().walk(k,m,this)}}if(this.thenPart!=null){this.thenPart.walk(k,m,this,"thenPart")}if(this.elsePart!=null){this.elsePart.walk(k,m,this,"elsePart")}if(this.cases){return i.each(this.cases,function(o){return o.statements.walk(k,m,o,"cases")})}};g.prototype.clone=function(l){var k;for(k in this){if(k==="tokenizer"||k==="length"||k==="filename"){continue}if(l[k]==null){l[k]=this[k]}}return new g(this.tokenizer,l)};g.prototype.toHash=function(k){var n,l,m;if(k==null){k=[]}n={};m=function(o){if(!o){return null}if(o.toHash){if(j.call(k,o)>=0){return"--recursive "+o.id+"--"}o.id=k.push(o);return o.toHash(k)}else{return o}};n.type=this.typeName();n.src=this.src();for(l in this){if(l==="filename"||l==="length"||l==="type"||l==="start"||l==="end"||l==="tokenizer"){continue}if(typeof this[l]==="function"){continue}if(!this[l]){continue}if(this[l].constructor===Array){n[l]=i.map(this[l],function(o){return m(o)})}else{n[l]=m(this[l])}}return n};g.prototype.inspect=function(){return JSON.stringify(this.toHash(),null,"  ")};g.prototype.src=function(){return this.tokenizer.source.substr(this.start,this.end-this.start)};g.prototype.typeName=function(){return c[this.type]};g.prototype.isA=function(){var l,k;l=1<=arguments.length?e.call(arguments,0):[];return k=c[this.type],j.call(l,k)>=0};c=(function(){var m,k,l;m={};l=0;for(k in h){if(typeof h[k]==="number"){m[h[k]]=k.toLowerCase();l=h[k]}}m[++l]="call_statement";m[++l]="existence_check";return m})();b=(function(){var l,k;l={};for(k in c){l[c[k]]=k}return l})();this.NodeExt=d={Types:c,Typenames:b,Node:g};if(typeof module!=="undefined"&&module!==null){module.exports=d}}).call(this);(function(){var d,h,f,r,s,k,g,e,i,j,b,t,m,o,a,n,l,q,c=Array.prototype.indexOf||function(v){for(var u=0,p=this.length;u<p;u++){if(u in this&&this[u]===v){return u}}return -1};h=this.CoffeeScript||require("coffee-script");d=(function(){function p(){this.code=""}p.prototype.add=function(u){this.code+=u.toString();return this};p.prototype.scope=function(v,w){var u;if(w==null){w=1}u=m("  ",w);this.code=b(this.code)+"\n";this.code+=u+b(v).replace(/\n/g,"\n"+u)+"\n";return this};p.prototype.toString=function(){return this.code};return p})();j=function(p){var u;u=p.toString();if(u.substr(0,1)==="("&&u.substr(-1,1)===")"){return u}else{return"("+u+")"}};m=function(v,u){var p;return((function(){var w;w=[];for(p=0;0<=u?p<u:p>u;0<=u?p++:p--){w.push(v)}return w})()).join("")};e=function(p){return(""+p).replace(/^\s*/g,"")};b=function(p){return(""+p).replace(/\s*$/g,"")};f=function(p){return(""+p).replace(/^\s*\n|\s*$/g,"")};o=function(p){return(""+p).replace(/^\s*|\s*$/g,"")};g=function(p){return o(p).indexOf("\n")===-1};l=function(v){var u,p;v=""+v;while(true){u=v.match(/^/gm);p=v.match(/^ /gm);if(!u||!p||u.length!==p.length){return v}v=v.replace(/^ /gm,"")}};a=function(p){return p.isA("true")||(p.isA("number")&&parseFloat(p.src())!==0)};t=function(p){return JSON.stringify(""+p)};i=function(p){if(p.constructor===String){console.log(JSON.stringify(p))}else{console.log(p)}return""};r=(function(){var w,u,v,p;v=h.RESERVED;p=[];for(w=0,u=v.length;w<u;w++){q=v[w];if(q!=="undefined"){p.push(q)}}return p})();n=function(u){var p;if(p=""+u,c.call(r,p)>=0){return""+u+"_"}else{return""+u}};k=function(p,u){return p+u.replace(/\n/g,"\n"+p)};this.Js2coffeeHelpers=s={Code:d,p:i,strEscape:t,unreserve:n,unshift:l,isSingleLine:g,trim:o,blockTrim:f,ltrim:e,rtrim:b,strRepeat:m,paren:j,truthy:a,indentLines:k};if(typeof module!=="undefined"&&module!==null){module.exports=s}}).call(this);(function(){var w,g,z,y,C,t,x,j,d,B,q,k,h,m,o,e,b,D,s,v,a,u,r,A,i,c,f=Array.prototype.indexOf||function(F){for(var E=0,p=this.length;E<p;E++){if(E in this&&this[E]===F){return E}}return -1},n=Array.prototype.slice,l=Object.prototype.hasOwnProperty;e=(this.Narcissus||require("./narcissus_packed")).parser;A=this._||require("underscore");i=this.NodeExt||require("./node_ext"),t=i.Types,C=i.Typenames,z=i.Node;c=this.Js2coffeeHelpers||require("./helpers"),g=c.Code,m=c.p,D=c.strEscape,u=c.unreserve,r=c.unshift,k=c.isSingleLine,v=c.trim,j=c.blockTrim,h=c.ltrim,b=c.rtrim,s=c.strRepeat,o=c.paren,a=c.truthy,q=c.indentLines;d=function(O,L){var P,G,J,Q,R,I,N,H,p,U,M,S,K,F,T,E;if(L==null){L={}}O=O.replace(/\r/g,"");O+="\n";P=new w(L);M=e.parse(O);H=v(P.build(M));if(L.no_comments){return((function(){var X,W,Y,V;Y=H.split("\n");V=[];for(X=0,W=Y.length;X<W;X++){I=Y[X];V.push(b(I))}return V})()).join("\n")}else{Q=L.show_src_lineno;U=[];E=H.split("\n");for(F=0,T=E.length;F<T;F++){R=E[F];S=[];K=R.replace(/\uFEFE([0-9]+).*?\uFEFE/g,function(V,W){S.push(parseInt(W));return""});S=A.sortBy(A.uniq(S),function(V){return V});K=b(K);J=K.match(/^\s*/);if(S.length>0){N=A.last(S);p=P.commentsNotDoneTo(N);if(p){U.push(q(J,p))}}if(K){if(Q){K=K+"#"+S.join(",")+"#  "}U.push(b(K+" "+h(P.lineComments(S))))}else{U.push("")}}G=P.commentsNotDoneTo(10000000000);if(G){U.push(G)}return U.join("\n")}};w=(function(){function p(E){this.options=E!=null?E:{};this.transformer=new y}p.prototype.l=function(E){if(this.options.no_comments){return""}if(E&&E.lineno){return"\uFEFE"+E.lineno+"\uFEFE"}else{return""}};p.prototype.makeComment=function(G){var F,E;if(G.type==="BLOCK_COMMENT"){F=G.value.split("\n");if(F.length>0&&F[0].length>0&&F[0][0]==="*"){F=(function(){var J,I,H;H=[];for(J=0,I=F.length;J<I;J++){E=F[J];H.push(E.replace(/^[\s\*]*/,""))}return H})();F=(function(){var J,I,H;H=[];for(J=0,I=F.length;J<I;J++){E=F[J];H.push(E.replace(/[\s]*$/,""))}return H})();while(F.length>0&&F[0].length===0){F.shift()}while(F.length>0&&F[F.length-1].length===0){F.pop()}F.unshift("###");F.push("###")}else{F=(function(){var J,I,H;H=[];for(J=0,I=F.length;J<I;J++){E=F[J];H.push("#"+E)}return H})()}}else{F=["#"+G.value]}if(G.nlcount>0){F.unshift("")}return F.join("\n")};p.prototype.commentsNotDoneTo=function(F){var G,E;E=[];while(true){if(this.comments.length===0){break}G=this.comments[0];if(G.lineno<F){E.push(this.makeComment(G));this.comments.shift();continue}break}return E.join("\n")};p.prototype.lineComments=function(F){var G,E;E=(function(){var J,I,L,K,H;L=this.comments;H=[];for(J=0,I=L.length;J<I;J++){G=L[J];if(K=G.lineno,f.call(F,K)>=0){H.push(G)}}return H}).call(this);this.comments=A.difference(this.comments,E);return((function(){var J,I,H;H=[];for(J=0,I=E.length;J<I;J++){G=E[J];H.push(this.makeComment(G))}return H}).call(this)).join("\n")};p.prototype.build=function(){var G,H,F,I,E;G=1<=arguments.length?n.call(arguments,0):[];I=G[0];if(!(this.comments!=null)){this.comments=A.sortBy(I.tokenizer.comments,function(J){return J.start})}this.transform(I);F="other";if(I!==void 0&&I.typeName){F=I.typeName()}H=this[F]||this.other;E=H.apply(this,G);if(I.parenthesized){return o(E)}else{return E}};p.prototype.transform=function(){var E;E=1<=arguments.length?n.call(arguments,0):[];return this.transformer.transform.apply(this.transformer,E)};p.prototype.body=function(F,E){var G;if(E==null){E={}}G=this.build(F,E);G=j(G);G=r(G);if(G.length>0){return G}else{return""}};p.prototype.script=function(H,E){var G,F=this;if(E==null){E={}}G=new g;A.each(H.functions,function(I){return G.add(F.build(I))});A.each(H.nonfunctions,function(I){return G.add(F.build(I))});return G.toString()};p.prototype.property_identifier=function(F){var E;E=F.value.toString();if(E.match(/^([_\$a-z][_\$a-z0-9]*)$/i)||E.match(/^[0-9]+$/i)){return this.l(F)+E}else{return this.l(F)+D(E)}};p.prototype.identifier=function(E){if(E.value==="undefined"){return this.l(E)+"`undefined`"}else{if(E.property_accessor){return this.l(E)+E.value.toString()}else{return this.l(E)+u(E.value.toString())}}};p.prototype.number=function(E){return this.l(E)+(""+(E.src()))};p.prototype.id=function(E){if(E.property_accessor){return this.l(E)+E}else{return this.l(E)+u(E)}};p.prototype.id_param=function(F){var E;if((E=F.toString())==="undefined"){return this.l(F)+(""+F+"_")}else{return this.l(F)+this.id(F)}};p.prototype["return"]=function(E){if(!(E.value!=null)){return this.l(E)+"return\n"}else{return this.l(E)+("return "+(this.build(E.value))+"\n")}};p.prototype[";"]=function(F){var E;if(F.expression==null){return""}else{if(F.expression.typeName()==="object_init"){E=this.object_init(F.expression);if(F.parenthesized){return E}else{return""+(r(j(E)))+"\n"}}else{return this.build(F.expression)+"\n"}}};p.prototype["new"]=function(E){return this.l(E)+("new "+(this.build(E.left())))};p.prototype.new_with_args=function(E){return this.l(E)+("new "+(this.build(E.left()))+"("+(this.build(E.right()))+")")};p.prototype.unary_plus=function(E){return"+"+(this.build(E.left()))};p.prototype.unary_minus=function(E){return"-"+(this.build(E.left()))};p.prototype["this"]=function(E){return this.l(E)+"this"};p.prototype["null"]=function(E){return this.l(E)+"null"};p.prototype["true"]=function(E){return this.l(E)+"true"};p.prototype["false"]=function(E){return this.l(E)+"false"};p.prototype["void"]=function(E){return this.l(E)+"undefined"};p.prototype["debugger"]=function(E){return this.l(E)+"debugger\n"};p.prototype["break"]=function(E){return this.l(E)+"break\n"};p.prototype["continue"]=function(E){return this.l(E)+"continue\n"};p.prototype["~"]=function(E){return"~"+(this.build(E.left()))};p.prototype["typeof"]=function(E){return this.l(E)+("typeof "+(this.build(E.left())))};p.prototype.index=function(F){var E;E=this.build(F.right());if(A.any(F.children,function(G){return G.typeName()==="object_init"&&G.children.length>1})){E="{"+E+"}"}return this.l(F)+(""+(this.build(F.left()))+"["+E+"]")};p.prototype["throw"]=function(E){return this.l(E)+("throw "+(this.build(E.exception)))};p.prototype["!"]=function(G){var E,F;F=G.left();E=1;while((F.isA("!"))&&(F=F.left())){++E}if((E&1)&&F.isA("==","!=","===","!==","in","instanceof")){F.negated=!F.negated;return this.build(F)}return this.l(G)+(""+(E&1?"not ":"!!")+(this.build(F)))};p.prototype["in"]=function(E){return this.binary_operator(E,"of")};p.prototype["+"]=function(E){return this.binary_operator(E,"+")};p.prototype["-"]=function(E){return this.binary_operator(E,"-")};p.prototype["*"]=function(E){return this.binary_operator(E,"*")};p.prototype["/"]=function(E){return this.binary_operator(E,"/")};p.prototype["%"]=function(E){return this.binary_operator(E,"%")};p.prototype[">"]=function(E){return this.binary_operator(E,">")};p.prototype["<"]=function(E){return this.binary_operator(E,"<")};p.prototype["&"]=function(E){return this.binary_operator(E,"&")};p.prototype["|"]=function(E){return this.binary_operator(E,"|")};p.prototype["^"]=function(E){return this.binary_operator(E,"^")};p.prototype["&&"]=function(E){return this.binary_operator(E,"and")};p.prototype["||"]=function(E){return this.binary_operator(E,"or")};p.prototype["<<"]=function(E){return this.binary_operator(E,"<<")};p.prototype["<="]=function(E){return this.binary_operator(E,"<=")};p.prototype[">>"]=function(E){return this.binary_operator(E,">>")};p.prototype[">="]=function(E){return this.binary_operator(E,">=")};p.prototype["==="]=function(E){return this.binary_operator(E,"is")};p.prototype["!=="]=function(E){return this.binary_operator(E,"isnt")};p.prototype[">>>"]=function(E){return this.binary_operator(E,">>>")};p.prototype["instanceof"]=function(E){return this.binary_operator(E,"instanceof")};p.prototype["=="]=function(E){return this.binary_operator(E,"is")};p.prototype["!="]=function(E){return this.binary_operator(E,"isnt")};p.prototype.binary_operator=(function(){var G,F,E;G={is:"isnt","in":"not in",of:"not of","instanceof":"not instanceof"};for(F in G){if(!l.call(G,F)){continue}E=G[F];G[E]=F}return function(I,H){if(I.negated){H=G[H]}return this.l(I)+(""+(this.build(I.left()))+" "+H+" "+(this.build(I.right())))}})();p.prototype["--"]=function(E){return this.increment_decrement(E,"--")};p.prototype["++"]=function(E){return this.increment_decrement(E,"++")};p.prototype.increment_decrement=function(F,E){if(F.postfix){return this.l(F)+(""+(this.build(F.left()))+E)}else{return this.l(F)+(""+E+(this.build(F.left())))}};p.prototype["="]=function(F){var E;E=F.assignOp!=null?t[F.assignOp]+"=":"=";return this.l(F)+(""+(this.build(F.left()))+" "+E+" "+(this.build(F.right())))};p.prototype[","]=function(G){var E,F=this;E=A.map(G.children,function(H){return F.l(H)+F.build(H)+"\n"});return E.join("")};p.prototype.regexp=function(I){var H,F,E,G;E=I.value.toString().match(/^\/(.*)\/([a-z]?)/);G=E[1];F=E[2];H=G[0];if(H===" "||H==="="){if(F.length>0){return this.l(I)+("RegExp("+(D(G))+', "'+F+'")')}else{return this.l(I)+("RegExp("+(D(G))+")")}}else{return this.l(I)+("/"+G+"/"+F)}};p.prototype.string=function(E){return this.l(E)+D(E.value)};p.prototype.call=function(E){if(E.right().children.length===0){return(""+(this.build(E.left()))+"()")+this.l(E)}else{return(""+(this.build(E.left()))+"("+(this.build(E.right()))+")")+this.l(E)}};p.prototype.call_statement=function(F){var E;E=this.build(F.left());if(F.left().isA("function")){E=o(E)}if(F.right().children.length===0){return(""+E+"()")+this.l(F)}else{return(""+E+" "+(this.build(F.right())))+this.l(F)}};p.prototype.list=function(G){var E,F=this;E=A.map(G.children,function(H){if(G.children.length>1){H.is_list_element=true}return F.build(H)});return this.l(G)+E.join(", ")};p.prototype["delete"]=function(G){var E,F=this;E=A.map(G.children,function(H){return F.build(H)});E=E.join(", ");return this.l(G)+("delete "+E+"\n")};p.prototype["."]=function(H){var G,E,F;G=this.build(H.left());F=H.right();F.property_accessor=true;E=this.build(F);if(H.isThis&&H.isPrototype){return this.l(H)+"@::"}else{if(H.isThis){return this.l(H)+("@"+E)}else{if(H.isPrototype){return this.l(H)+(""+G+"::")}else{if(H.left().isPrototype){return this.l(H)+(""+G+E)}else{return this.l(H)+(""+G+"."+E)}}}}};p.prototype["try"]=function(G){var F,E=this;F=new g;F.add("try");F.scope(this.body(G.tryBlock));A.each(G.catchClauses,function(H){return F.add(E.build(H))});if(G.finallyBlock!=null){F.add("finally");F.scope(this.body(G.finallyBlock))}return this.l(G)+F};p.prototype["catch"]=function(G){var E,F;E=this.body(G.block);if(v(E).length===0){return""}F=new g;if(G.varName!=null){F.add("catch "+G.varName)}else{F.add("catch")}F.scope(this.body(G.block));return this.l(G)+F};p.prototype["?"]=function(E){return this.l(E)+("(if "+(this.build(E.left()))+" then "+(this.build(E.children[1]))+" else "+(this.build(E.children[2]))+")")};p.prototype["for"]=function(F){var E;E=new g;if(F.setup!=null){E.add(""+(this.build(F.setup))+"\n")}if(F.condition!=null){E.add("while "+(this.build(F.condition))+"\n")}else{E.add("loop")}E.scope(this.body(F.body));if(F.update!=null){E.scope(this.body(F.update))}return this.l(F)+E};p.prototype.for_in=function(F){var E;E=new g;E.add("for "+(this.build(F.iterator))+" of "+(this.build(F.object)));E.scope(this.body(F.body));return this.l(F)+E};p.prototype["while"]=function(I){var E,H,F,G;H=new g;F=I.positive?"while":"until";E=this.body(I.body);if(a(I.condition)){G="loop"}else{G=""+F+" "+(this.build(I.condition))}if(k(E)&&G!=="loop"){H.add(""+(v(E))+"  "+G+"\n")}else{H.add(G);H.scope(E)}return this.l(I)+H};p.prototype["do"]=function(F){var E;E=new g;E.add("loop");E.scope(this.body(F.body));if(F.condition!=null){E.scope("break unless "+(this.build(F.condition)))}return this.l(F)+E};p.prototype["if"]=function(H){var E,G,F;G=new g;F=H.positive?"if":"unless";E=this.body(H.thenPart);H.condition.parenthesized=false;if(H.thenPart.isA("block")&&H.thenPart.children.length===0&&!(H.elsePart!=null)){console.log(H.thenPart);G.add(""+(this.build(H.condition))+"\n")}else{if(k(E)&&!(H.elsePart!=null)){G.add(""+(v(E))+"  "+F+" "+(this.build(H.condition))+"\n")}else{G.add(""+F+" "+(this.build(H.condition)));G.scope(this.body(H.thenPart));if(H.elsePart!=null){if(H.elsePart.typeName()==="if"){G.add("else "+(this.build(H.elsePart).toString()))}else{G.add(this.l(H.elsePart)+"else\n");G.scope(this.body(H.elsePart))}}}}return this.l(H)+G};p.prototype["switch"]=function(H){var G,E,F=this;G=new g;G.add("switch "+(this.build(H.discriminant))+"\n");E=false;A.each(H.cases,function(I){var J;if(I.value==="default"){G.scope(F.l(I)+"else")}else{if(E===true){G.add(F.l(I)+(", "+(F.build(I.caseLabel))+"\n"))}else{G.add(F.l(I)+("  when "+(F.build(I.caseLabel))))}}if(F.body(I.statements).length===0){E=true}else{E=false;G.add("\n");G.scope(F.body(I.statements),2)}return J=false});return this.l(H)+G};p.prototype.existence_check=function(E){return this.l(E)+(""+(this.build(E.left()))+"?")};p.prototype.array_init=function(E){if(E.children.length===0){return this.l(E)+"[]"}else{return this.l(E)+("["+(this.list(E))+"]")}};p.prototype.property_init=function(G){var F,E;F=G.left();E=G.right();E.is_property_value=true;return""+(this.property_identifier(F))+": "+(this.build(E))};p.prototype.object_init=function(I,E){var H,F,G=this;if(E==null){E={}}if(I.children.length===0){return this.l(I)+"{}"}else{if(I.children.length===1&&!(I.is_property_value||I.is_list_element)){return this.build(I.children[0])}else{F=A.map(I.children,function(J){return G.build(J)});H=new g(this,I);H.scope(F.join("\n"));if(E.brackets!=null){H="{"+H+"}"}return H}}};p.prototype["function"]=function(I){var E,H,F,G=this;H=new g;F=A.map(I.params,function(J){if(J.constructor===String){return G.id_param(J)}else{return G.build(J)}});if(I.name){H.add(""+I.name+" = ")}if(I.params.length>0){H.add("("+(F.join(", "))+") ->")}else{H.add("->")}E=this.body(I.body);if(v(E).length>0){H.scope(E)}else{H.add("\n")}return this.l(I)+H};p.prototype["var"]=function(G){var E,F=this;E=A.map(G.children,function(H){return""+(u(H.value))+" = "+(H.initializer!=null?F.build(H.initializer):"undefined")});return this.l(G)+A.compact(E).join("\n")+"\n"};p.prototype.other=function(E){return this.unsupported(E,""+(E.typeName())+" is not supported yet")};p.prototype.getter=function(E){return this.unsupported(E,"getter syntax is not supported; use __defineGetter__")};p.prototype.setter=function(E){return this.unsupported(E,"setter syntax is not supported; use __defineSetter__")};p.prototype.label=function(E){return this.unsupported(E,"labels are not supported by CoffeeScript")};p.prototype["const"]=function(E){return this.unsupported(E,"consts are not supported by CoffeeScript")};p.prototype.block=function(){var E;E=1<=arguments.length?n.call(arguments,0):[];return this.script.apply(this,E)};p.prototype.unsupported=function(F,E){throw new x("Unsupported: "+E,F)};return p})();y=(function(){function p(){}p.prototype.transform=function(){var E,G,H,F;E=1<=arguments.length?n.call(arguments,0):[];H=E[0];if(H.transformed!=null){return}F=H.typeName();G=this[F];if(G){G.apply(this,E);return H.transformed=true}};p.prototype.script=function(G){var E,F=this;G.functions=[];G.nonfunctions=[];A.each(G.children,function(H){if(H.isA("function")){return G.functions.push(H)}else{return G.nonfunctions.push(H)}});E=null;return A.each(G.nonfunctions,function(H){var I;if(H.expression!=null){I=H.expression;if((E!=null?E.isA("object_init"):void 0)&&I.isA("object_init")){H.parenthesized=true}else{H.parenthesized=false}return E=I}})};p.prototype["."]=function(E){E.isThis=E.left().isA("this");return E.isPrototype=E.right().isA("identifier")&&E.right().value==="prototype"};p.prototype[";"]=function(E){if(E.expression!=null){E.expression.parenthesized=false;if(E.expression.isA("call")){E.expression.type=C.call_statement;return this.call_statement(E)}}};p.prototype["function"]=function(E){return E.body.walk({last:true},function(F,H,I){var G;if(H.isA("return")&&H.value){G=I?F[I]:F.children[F.children.length-1];if(G){G.type=C[";"];return G.expression=G.value}}})};p.prototype["switch"]=function(F){var E=this;return A.each(F.cases,function(H){var J,G,I;J=H.statements;G=J.children;if((I=J.last())!=null?I.isA("break"):void 0){return delete G[G.length-1]}})};p.prototype.call_statement=function(E){if(E.children[1]){return A.each(E.children[1].children,function(G,F){if(G.isA("function")&&F!==E.children[1].children.length-1){return G.parenthesized=true}})}};p.prototype["return"]=function(E){if(E.value&&E.value.isA("object_init")&&E.value.children.length>1){return E.value.parenthesized=true}};p.prototype.block=function(E){return this.script(E)};p.prototype["if"]=function(F){var E;if(F.thenPart.children.length===0&&((E=F.elsePart)!=null?E.children.length:void 0)>0){F.positive=false;F.thenPart=F.elsePart;delete F.elsePart}return this.inversible(F)};p.prototype["while"]=function(E){if(E.body.children.length===0){E.body.children.push(E.clone({type:C["continue"],value:"continue",children:[]}))}return this.inversible(E)};p.prototype.inversible=function(F){var E;this.transform(F.condition);E=F.positive!=null?F.positive:true;if(F.condition.isA("!=")){F.condition.type=C["=="];return F.positive=!E}else{if(F.condition.isA("!")){F.condition=F.condition.left();return F.positive=!E}else{return F.positive=E}}};p.prototype["=="]=function(E){if(E.right().isA("null","void")){E.type=C["!"];return E.children=[E.clone({type:C.existence_check,children:[E.left()]})]}};p.prototype["!="]=function(E){if(E.right().isA("null","void")){E.type=C.existence_check;return E.children=[E.left()]}};return p})();x=(function(){function p(F,E){this.message=F;this.cursor=E.start;this.line=E.lineno;this.source=E.tokenizer.source}p.prototype.toString=function(){return this.message};return p})();this.Js2coffee=B={VERSION:"0.2.0",build:d,UnsupportedError:x};if(typeof module!=="undefined"&&module!==null){module.exports=B}}).call(this);